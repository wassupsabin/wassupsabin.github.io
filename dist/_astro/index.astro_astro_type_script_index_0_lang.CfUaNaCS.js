import{A as g}from"./a11y.rUtoWD6B.js";async function y(e){try{const t=await fetch("/api/subscribe-newsletter",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error("Subscription failed");return await t.json()}catch(t){return console.error("Newsletter subscription error:",t),{success:!1,errors:[{field:"general",message:"Failed to subscribe. Please try again."}]}}}const h=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e),o=(e,t,s)=>{e&&(e.textContent=t,e.classList.remove("hidden"),s?.announce(t))},w=(e,t,s)=>{e&&(e.textContent=t,e.classList.remove("hidden"),s?.announce(t))},b=(e,t)=>{e&&(e.textContent="",e.classList.add("hidden"),t?.removeAttribute("aria-invalid"))},c=document.getElementById("newsletter-form"),a=document.getElementById("newsletter-email"),n=document.getElementById("newsletter-error"),i=document.getElementById("success-message"),l=c?.querySelector('button[type="submit"]'),d=document.getElementById("submit-text"),u=document.getElementById("submit-loading"),r=g.getInstance(),m=e=>{l&&d&&u&&(l.disabled=e,d.classList.toggle("hidden",e),u.classList.toggle("hidden",!e))};c?.addEventListener("submit",async e=>{e.preventDefault(),b(n,a),i?.classList.add("hidden");const t=a?.value.trim();if(!t){o(n,"Please enter your email address",r);return}if(!h(t)){o(n,"Please enter a valid email address",r);return}m(!0);try{const s=await y({email:t});if(s.success)c.reset(),w(i,s.message||"Thank you for subscribing to our newsletter!",r),i?.focus();else{const f=s.errors?.[0]?.message||"Failed to subscribe. Please try again.";o(n,f,r)}}catch{o(n,"Failed to subscribe. Please try again.",r)}finally{m(!1)}});a?.addEventListener("input",()=>{b(n,a)});
